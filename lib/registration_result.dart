// Corresponds to AuthenticatorAttestationResponse
import 'package:fido2_client/signing_result.dart';

class RegistrationResult {
  RegistrationResult(this.keyHandle, this.clientData, this.attestationObj);

  /// This is the identifier for the credential generated by the authenticator.
  ///
  /// It will is used by the WebAuthn server and the FIDO client to identify
  /// which credential is being verified.
  ///
  /// Encoded in Base64URL
  String keyHandle;

  /// This is the JSON which contains client data that was involved in the creation
  /// of the credential.
  ///
  /// e.g. clientDataJSON:
  /// {"type":"webauthn.create",
  /// "challenge":"randomchallenge123132w",
  /// "origin":"android:apk-key-hash:JHlnXtZwMQ58Zub2_zAzw_Dg8GJQS5_yMmgjfi6cw3g",
  /// "androidPackageName":"mojaloop.fido2.fido2_client_example"}
  ///
  /// Encoded in Base64URL
  String clientData;

  /// The attestation object contains authenticator data is the same as
  /// [SigningResult.authData]
  ///
  /// It may also contain a signature if the format of the attestation is set to
  /// something than "none". Note that this signature is not created by using the newly
  /// generated private key but a private key that belongs to the authenticator
  /// when it is manufactured.
  ///
  /// Encoded in Base64URL AND CBOR
  /// You must decode using Base64URL and then decode using a CBOR library to access
  /// the fields.
  ///
  String attestationObj;
}